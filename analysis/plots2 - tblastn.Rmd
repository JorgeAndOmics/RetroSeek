---
title: "enERVate Modular Analysis"
output: html_notebook
---

```{r message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(ggmosaic)
library(ggridges)
```

```{r}
data <- read.csv('../data/tables/output/tblastn_results.csv')
```


```{r}
head(data)
```

```{r}
plot1 <- ggplot(data, aes(x=Family)) +
         geom_bar() + 
         facet_grid(.~Species) +
         geom_bar(fill = "steelblue") +
         theme_minimal() +
         labs(title = "Distribution of Virus Families",
           x = "Virus Family",
           y = "Count") +
         theme(axis.text.x = element_text(angle = 45, hjust = 1))

plot1
```

```{r}
probe_counts <- data %>%
  count(Probe) %>%
  mutate(proportion = n / sum(n))

plot2 <- ggplot(probe_counts, aes(x = "", y = proportion, fill = Probe)) +
         geom_bar(stat = "identity", width = 1) +
         coord_polar(theta = "y") +
         theme_void() +
         labs(title = "Full Proportion of Probe Types") +
         theme(legend.position = "right")

plot2
```

```{r}
probe_family_counts <- data %>%
  count(Family, Probe)

plot3 <- ggplot(probe_family_counts, aes(x = Family, y = n, fill = Probe)) +
         geom_bar(stat = "identity", position = "stack") +
         theme_minimal() +
         labs(title = "Relative Abundance of Probes Related to Families",
             x = "Virus Family",
             y = "Proportion",
             fill = "Probe") +
         theme(axis.text.x = element_text(angle = 45, hjust = 1))

plot3
```

```{r}
probe_virus_counts <- data %>%
  count(Abbreviation, Probe)

plot4 <- ggplot(probe_virus_counts, aes(x = Abbreviation, y = n, color = Probe)) +
         geom_point(size = 3, position = position_jitter(width = 0.2, height = 0))+
         theme_minimal() +
         labs(title = "Distribution of Probe Findings Across Viruses",
             x = "Virus Abbreviation",
             y = "Number of Findings",
             color = "Probe") +
         theme(axis.text.x = element_text(angle = 45, hjust = 1))

plot4
```

```{r}
heatmap_data <- data %>%
                count(Abbreviation, Family, Probe)

plot5 <- ggplot(heatmap_data, aes(x = Abbreviation, y = Family, fill = n)) +
         geom_tile() +
         scale_fill_gradient(low = "white", high = "steelblue") +
         theme_minimal() +
         labs(title = "Heatmap of Probe Counts Across Virus Abbreviations and Families",
             x = "Virus Abbreviation",
             y = "Family",
             fill = "Count") +
         theme(axis.text.x = element_text(angle = 45, hjust = 1))

plot5
```

```{r}
faceted_data <- data %>%
                count(Abbreviation, Probe, Family)

plot6 <- ggplot(faceted_data, aes(x = Abbreviation, y = n, fill = Probe)) +
         geom_bar(stat = "identity") +
         facet_wrap(~ Family, scales = "free_x") +
         theme_minimal() +
         labs(title = "Count of Probes for Each Virus Abbreviation by Family",
             x = "Virus Abbreviation",
             y = "Count",
             fill = "Probe") +
         theme(axis.text.x = element_text(angle = 45, hjust = 1))

plot6
```

```{r}
bubble_data <- data %>%
               count(Abbreviation, Species, Probe)

plot7 <- ggplot(bubble_data, aes(x = Abbreviation, y = Species, size = n, color = Probe)) +
         geom_point(alpha = 0.7) +
         theme_minimal() +
         labs(title = "Bubble Plot of Probe Distribution Across Virus Abbreviations and Species",
             x = "Virus Abbreviation",
             y = "Species",
             size = "Count",
             color = "Probe") +
         theme(axis.text.x = element_text(angle = 45, hjust = 1))

plot7
```

```{r}
density_data <- data %>%
                count(Abbreviation, Probe)

plot8 <- ggplot(density_data, aes(x = n, fill = Probe)) +
         geom_density(alpha = 0.7) +
         theme_minimal() +
         labs(title = "Density Plot of Probe Counts",
             x = "Number of Findings",
             y = "Density",
             fill = "Probe")

plot8
```

```{r}
lollipop_data <- data %>%
                 count(Abbreviation, Probe)

plot9 <- ggplot(lollipop_data, aes(x = Abbreviation, y = n, color = Probe)) +
         geom_segment(aes(x = Abbreviation, xend = Abbreviation, y = 0, yend = n), size = 1) +
         geom_point(size = 4) +
         theme_minimal() +
         labs(title = "Lollipop Chart of Probe Counts by Virus Abbreviation",
               x = "Virus Abbreviation",
               y = "Number of Findings",
               color = "Probe") +
         theme(axis.text.x = element_text(angle = 45, hjust = 1))

plot9
```
